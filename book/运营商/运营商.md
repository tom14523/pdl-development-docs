# <center><span id="同盾">同盾</span></center>


## 1. 接口地址
 > /api/yys/reoprt

## 2. 请求参数
| 参数名 | 类型 | 说明 | 是否必需 | 备注 |
| --| -- | -- | -- | -- |
| user_id    | string | 调用方生成的用户ID                 | Y |长度最大为64位）  |
| id_card    | string | 身份证号                                              		     | Y |  |
| name       | string | 姓名 						     | Y | 需要 UrlEncode |
| mobile     | string | 手机号 						 | Y |  |
| notify_url | string | 服务器异步通知页面路径 （长度最大为128位）     | Y | 需要 UrlEncode |
| return_url | string | 页面跳转同步通知页面路径 （长度最大为512位）| Y | returnUrl不传，会出现认证链接失效问题 ,需要 UrlEncode  |
| contacts   | json   | 紧急联系人 						 | N | 需要 UrlEncode|

**回调state字段释义**

| 参数名 |  说明 | 
| -- |  -- |
| init | 初始化 |  
| login   | 登录成功 |  
| crawl | 抓取成功 |  
| crawl_fail | 抓取失败 | 
| report | 生成报告成功 |  
| report_fail | 生成报告失败 | 


**认证成功跳转returnUrl的传给商户的参数(GET)**

| 参数名 | 类型 | 必须 | 备注 |
| -- | -- | -- | -- |
| userId     | String | 是 | 传入的userId，传入为空时返回系统自动生成userId |
| outUniqueId     | String | 是  | 调用方生成的会话唯一标识id|
| state    | String | 是   |请求状态  |
 

**后台回调notifyUrl传给商户的参数(POST)**

`注：登录成功以后才会有回调；在登录成功，抓取和报告部分都会进行回调`
| 参数名 | 类型 | 必须 | 备注 |
| -- | -- | -- | -- |
| userId     | String | 是 | 传入的userId，传入为空时返回系统自动生成userId |
| outUniqueId     | String | 是  | 调用方生成的会话唯一标识id|
| state    | String | 是   |状态 ‘login’,crawl’, ‘crawl_fail’, ‘report’, ‘report_fail’  |
| account    | String | 是   |查询的账户名 |
| search_id    | String | 是   |查询ID |
| accountType    | String | 是   |抓取类型 |
| errorReasonDetail    | String | 是   |只有运营商在抓取失败的情况下会返回此字段 |

## 3. 请求示例
```json
{
  "app_id":"abc",
  "sign":"",
  "biz_data":{
  	"user_id":"123456789",
    "id_card":"123213213282767",
    "name":"%e5%8d%a2%e6%b7%91%e6%a2%85",
    "mobile":"13599648818",
    "notify_url":"http%253a%252f%252flocalhost%253a8080%252freoprt",
    "return_url":"http%253a%252f%252flocalhost%253a8080%252freoprt",
    "contacts":"%5b%7b%22name%22%3a%22%e5%bc%a0%e4%b8%89%22%2c%22mobile%22%3a%221300000000%22%7d%2c%7b%22name%22%3a%22%e6%9d%8e%e5%9b%9b%22%2c%22mobile%22%3a%221300000001%22%7d%5d"
  },
  "sign_type":"RSA",
  "timestamp":"1234567890"
}
```
## 4. 响应示例
* 正常响应示例 
```json
{
    "error": 200,
    "msg": null,
    "tianji_api_tianjireport_collectuser_response": {
        "userId": "111",
        "outUniqueId": "2017010101010101",
        "redirectUrl": "https:\/\/tianji.rong360.com\/tianjiwapreport\/login?data=nD%2BRaNTUBXKJrM1QPpIetAWrE6MrA%2BY3XsXV8RBRpXZXdp06yTMhd0V1KE9SchzHipT4gpfaQwEf%2BsXY4xc6nnAJVyarKpEFvbUWa9C8fv5WShWEBB1oG8T%2F0aVEm6njtUf38I2VKVz08gA%2FoX8l4jppFCkZpAeuu6%2FPwZaMuDoLMqzLvojCh%2BE2v%2FompiO%2FACR73S7wE9yjiap19CiCaPz4T%2BDl2aBZddtuQxKz5iU%3D"
    }
}
```
